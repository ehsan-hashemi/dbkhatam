<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ú†Øª Ø±ÙˆÙ… Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</title>
  <style>
    @font-face {
      font-family: 'Vazir';
      src: url('/Vazir-Regular.ttf') format('truetype');
    }
    body {
      font-family: 'Vazir', sans-serif;
      direction: rtl;
      display: flex;
      margin: 0;
      background: #222;
      color: white;
    }
    .container {
      display: flex;
      width: 100vw;
      height: 100vh;
    }
    /* sidebar */
    .sidebar {
      width: 25%;
      background: #2a2a3a;
      padding: 10px;
      overflow-y: auto;
    }
    .chat-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .chat-item {
      display: flex;
      align-items: center;
      padding: 10px;
      border-radius: 5px;
      cursor: pointer;
      transition: 0.3s;
      background: #3a3a4a;
      margin: 5px 0;
      position: relative;
    }
    .chat-item:hover {
      background: #4b4b5c;
    }
    .chat-image {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-left: 10px;
      object-fit: cover;
    }
    /* chat area */
    .chat-area {
      flex-grow: 1;
      display: flex;
      flex-direction: column;
      padding: 15px;
      align-items: center;
    }
    .chat-header {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }
    .chat-profile {
      width: 50px;
      height: 50px;
      border-radius: 50%;
      object-fit: cover;
    }
    .chat-box {
      flex-grow: 1;
      width: 90%;
      background: #29293f;
      padding: 10px;
      border-radius: 10px;
      overflow-y: auto;
      margin-bottom: 10px;
    }
    .input-area {
      display: flex;
      width: 90%;
      gap: 5px;
      margin-bottom: 10px;
    }
    #message-input {
      flex-grow: 1;
      padding: 8px;
      border: none;
      border-radius: 5px;
      font-family: "Vazir";
    }
    button {
      padding: 8px 12px;
      cursor: pointer;
      background: #4caf50;
      border: none;
      color: white;
      border-radius: 5px;
      font-family: "Vazir";
    }
    /* context menu */
    .context-menu {
      display: none;
      position: absolute;
      z-index: 1000;
      background: #fff;
      color: black;
      border-radius: 5px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.2);
    }
    .context-menu ul {
      list-style: none;
      padding: 5px 0;
      margin: 0;
    }
    .context-menu ul li {
      padding: 8px 15px;
      cursor: pointer;
      transition: 0.3s;
    }
    .context-menu ul li:hover {
      background: #ddd;
    }
  </style>
</head>
<body>
  <div class="container">
    <aside class="sidebar">
      <h3>ğŸ‘¥ Ù„ÛŒØ³Øª Ú†Øªâ€ŒÙ‡Ø§ <button onclick="addChat()">â•</button></h3>
      <ul id="chatList" class="chat-list"></ul>
    </aside>
    <main class="chat-area">
      <div class="chat-header">
        <img id="chatProfile" class="chat-profile" src="/images/person_24dp_1F1F1F_FILL0_wght400_GRAD0_opsz24.svg" alt="Profile">
        <h2 id="chatTitle">Ø§Ù†ØªØ®Ø§Ø¨ Ú†Øª...</h2>
      </div>
      <div id="chat-box" class="chat-box"></div>
      <div class="input-area">
        <input type="text" id="message-input" placeholder="Ù¾ÛŒØ§Ù… Ø®ÙˆØ¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯..." disabled>
        <button id="send-button" onclick="sendMessage()" disabled>Ø§Ø±Ø³Ø§Ù„</button>
      </div>
    </main>
  </div>

  <div id="contextMenu" class="context-menu">
    <ul>
      <li onclick="renameChat()">âœï¸ ØªØºÛŒÛŒØ± Ù†Ø§Ù…</li>
      <li onclick="changeProfile()">ğŸ–¼ ØªØºÛŒÛŒØ± Ø¹Ú©Ø³ Ù¾Ø±ÙˆÙØ§ÛŒÙ„</li>
      <li onclick="clearMessages()">ğŸ§¹ Ø­Ø°Ù Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§</li>
      <li onclick="deleteChat()">ğŸ—‘ Ø­Ø°Ù Ù…Ø®Ø§Ø·Ø¨</li>
      <li onclick="markAsRead()">âœ”ï¸ Ø®ÙˆØ§Ù†Ø¯Ù‡ Ø´Ø¯Ù‡</li>
    </ul>
  </div>

  <script>
    // Ø¯Ø±ÛŒØ§ÙØª Ú†Øªâ€ŒÙ‡Ø§ Ø§Ø² localStorage ÛŒØ§ Ø´Ø±ÙˆØ¹ Ø¨Ø§ Ø¢Ø±Ø§ÛŒÙ‡ Ø®Ø§Ù„ÛŒ
    let chats = JSON.parse(localStorage.getItem("chats")) || [];
    let selectedChat = null;

    // Ø¨Ù‡â€ŒØ±ÙˆØ² Ø±Ø³Ø§Ù†ÛŒ Ù„ÛŒØ³Øª Ú†Øªâ€ŒÙ‡Ø§
    function updateChatList() {
      const chatList = document.getElementById("chatList");
      chatList.innerHTML = "";
      chats.forEach((chat, index) => {
        let li = document.createElement("li");
        li.className = "chat-item";
        li.innerHTML = `<img src="${chat.image || '/images/person_24dp_1F1F1F_FILL0_wght400_GRAD0_opsz24.svg'}" class="chat-image" alt="Profile">${chat.name}`;
        li.onclick = function(e) {
          selectChat(index);
          e.stopPropagation();
        };
        li.addEventListener("contextmenu", function(e) {
          e.preventDefault();
          showContextMenu(e, index);
        });
        chatList.appendChild(li);
      });
      localStorage.setItem("chats", JSON.stringify(chats));
    }

    // Ø§ÙØ²ÙˆØ¯Ù† Ù…Ø®Ø§Ø·Ø¨ Ø¬Ø¯ÛŒØ¯
    function addChat() {
      const name = prompt("Ù†Ø§Ù… Ù…Ø®Ø§Ø·Ø¨ Ø¬Ø¯ÛŒØ¯:");
      if (name) {
        chats.push({
          name: name,
          image: '/images/person_24dp_1F1F1F_FILL0_wght400_GRAD0_opsz24.svg',
          messages: []
        });
        updateChatList();
      }
      const phone = prompt("Ø´Ù…Ø§Ø±Ù‡ ØªÙ„ÙÙ† Ù…Ø®Ø§Ø·Ø¨ Ø¬Ø¯ÛŒØ¯:")
    }

    // Ø§Ù†ØªØ®Ø§Ø¨ ÛŒÚ© Ù…Ø®Ø§Ø·Ø¨ Ø¨Ø±Ø§ÛŒ Ú†Øª
    function selectChat(index) {
      selectedChat = index;
      document.getElementById("chatTitle").innerText = chats[index].name;
      document.getElementById("chatProfile").src = chats[index].image;
      document.getElementById("message-input").disabled = false;
      document.getElementById("send-button").disabled = false;
      updateMessages();
    }

    // Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… â€“ Ø¨Ø§ Ø¯Ú©Ù…Ù‡ ÛŒØ§ ÙØ´Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡ Ø§ÛŒÙ†ØªØ±
    function sendMessage() {
      const input = document.getElementById("message-input");
      const message = input.value.trim();
      if (message && selectedChat !== null) {
        chats[selectedChat].messages.push(`ğŸ”¹ Ø´Ù…Ø§: ${message}`);
        updateMessages();
        input.value = "";
      }
    }

    // Ø§Ø±Ø³Ø§Ù„ Ù¾ÛŒØ§Ù… Ø¨Ø§ ÙØ´Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡ Ø§ÛŒÙ†ØªØ±
    document.getElementById("message-input").addEventListener("keydown", function(event) {
      if (event.key === "Enter") {
        event.preventDefault(); // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø±ÙØªÙ† Ø¨Ù‡ Ø®Ø· Ø¨Ø¹Ø¯ÛŒ
        sendMessage();
      }
    });

    // Ø¨Ù‡â€ŒØ±ÙˆØ² Ø±Ø³Ø§Ù†ÛŒ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ Ø¯Ø± Ù‚Ø³Ù…Øª Ú†Øª
    function updateMessages() {
      const chatBox = document.getElementById("chat-box");
      chatBox.innerHTML = "";
      chats[selectedChat].messages.forEach(msg => {
        const p = document.createElement("p");
        p.textContent = msg;
        chatBox.appendChild(p);
      });
      localStorage.setItem("chats", JSON.stringify(chats));
    }

    // Ù†Ù…Ø§ÛŒØ´ Ù…Ù†ÙˆÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª (Ø±Ø§Ø³Øªâ€ŒÚ©Ù„ÛŒÚ©)
    function showContextMenu(event, index) {
      selectedChat = index;
      const menu = document.getElementById("contextMenu");
      menu.style.top = event.clientY + "px";
      menu.style.left = event.clientX + "px";
      menu.style.display = "block";
    }

    // Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ù…Ù†ÙˆÛŒ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù‡Ù†Ú¯Ø§Ù… Ú©Ù„ÛŒÚ© Ø¯Ø± ØµÙØ­Ù‡
    window.addEventListener("click", function() {
      document.getElementById("contextMenu").style.display = "none";
    });

    // ØªØºÛŒÛŒØ± Ù†Ø§Ù… Ù…Ø®Ø§Ø·Ø¨
    function renameChat() {
      const newName = prompt("Ù†Ø§Ù… Ø¬Ø¯ÛŒØ¯:");
      if (newName && selectedChat !== null) {
        chats[selectedChat].name = newName;
        updateChatList();
        selectChat(selectedChat);
      }
    }

    // Ø­Ø°Ù Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§
    function clearMessages() {
      if (selectedChat !== null) {
        chats[selectedChat].messages = [];
        updateMessages();
      }
    }

    // Ø­Ø°Ù Ù…Ø®Ø§Ø·Ø¨
    function deleteChat() {
      if (selectedChat !== null && confirm("Ø¢ÛŒØ§ Ù…Ø®Ø§Ø·Ø¨ Ø­Ø°Ù Ø´ÙˆØ¯ØŸ")) {
        chats.splice(selectedChat, 1);
        selectedChat = null;
        updateChatList();
        document.getElementById("chatTitle").innerText = "Ø§Ù†ØªØ®Ø§Ø¨ Ú†Øª...";
        document.getElementById("chatProfile").src = "/images/person_24dp_1F1F1F_FILL0_wght400_GRAD0_opsz24.svg";
        document.getElementById("message-input").disabled = true;
        document.getElementById("send-button").disabled = true;
        document.getElementById("chat-box").innerHTML = "";
      }
    }

    // ØªØºÛŒÛŒØ± Ø¹Ú©Ø³ Ù¾Ø±ÙˆÙØ§ÛŒÙ„ Ø§Ø² Ø·Ø±ÛŒÙ‚ Ø§Ù†ØªØ®Ø§Ø¨ ÙØ§ÛŒÙ„ Ø§Ø² Ø¯Ø³ØªÚ¯Ø§Ù‡
    function changeProfile() {
      if (selectedChat === null) return;
      const fileInput = document.createElement("input");
      fileInput.type = "file";
      fileInput.accept = "image/*";
      fileInput.onchange = function(event) {
        const file = event.target.files[0];
        if (file) {
          const reader = new FileReader();
          reader.onload = function(e) {
            chats[selectedChat].image = e.target.result;
            updateChatList();
            selectChat(selectedChat);
          };
          reader.readAsDataURL(file);
        }
      };
      fileInput.click();
    }

    // Ø¹Ù„Ø§Ù…Øª Ú¯Ø°Ø§Ø±ÛŒ Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø®ÙˆØ§Ù†Ø¯Ù‡ Ø´Ø¯Ù‡ (Ø¹Ù…Ù„Ú©Ø±Ø¯ Ù†Ù…ÙˆÙ†Ù‡)
    function markAsRead() {
      alert("Ù¾ÛŒØ§Ù…â€ŒÙ‡Ø§ÛŒ Ø§ÛŒÙ† Ú†Øª Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† Ø®ÙˆØ§Ù†Ø¯Ù‡ Ø´Ø¯Ù‡ Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ø´Ø¯Ù†Ø¯.");
    }

    // Ø±Ø§Ù‡â€ŒØ§Ù†Ø¯Ø§Ø²ÛŒ Ø§ÙˆÙ„ÛŒÙ‡ Ù„ÛŒØ³Øª Ú†Øªâ€ŒÙ‡Ø§
    updateChatList();
  </script>
</body>
</html>
